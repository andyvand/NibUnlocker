<html lang="en"><head><meta charset="UTF-8"><title>If a build has an entitlement error</title><meta name="description" content="If an entitlement error occurs at installation or runtime, you can use command-line utilities to compare the app’s signature to the embedded provisioning profile."></head><body dir="ltr" id="dev298d7b2cb" class="AppleTopic apd-topic" data-isTaskOpen="false"><a name="dev298d7b2cb"></a><figure class="topicIcon"><img src="../GlobalArt/AppIconDefault.png" alt="" height="30" width="30"></figure><h1>If a build has an entitlement error</h1><div class="Alert"><p class="Tip"><strong class="tip">Tip: </strong>If you use <a href="dev80cc24546.html#dev80cc24546" class="xRef Aside">automatic signing</a> (recommended), Xcode repairs most code signing errors for you.</p></div><p>If an <a href="dev5f8bfd349.html#dev5f8bfd349" class="xRef Aside">entitlement</a> error occurs at installation or runtime, you should verify the capabilities you added and signing certificate you used while developing the app in Xcode. Then use command-line utilities to verify the signature of the app and examine the provisioning profile that is embedded in the app.</p><p>Some entitlements (for example, <a href="dev508eca2dd.html#dev508eca2dd" class="xRef Aside">App Sandbox</a> entitlements) are set in your Xcode project and are applied to the signature. Other entitlements are enabled for an App ID and contained in the provisioning profile. You can check if the signature has the correct entitlements and if discrepancies occur, examine the embedded provisioning profile.</p><p>These steps show how to examine a build in Xcode but you can use these same commands on a build you distribute to users. To create a build in Xcode, <a href="dev5a825a1ca.html#dev5a825a1ca" class="xRef AppleTopic">launch an app on a device</a>. If you don’t have a device, choose the generic device from the Scheme menu. For macOS apps, just <a href="devdc0193470.html#devdc0193470" class="xRef AppleTopic">build and run your app</a> before performing these steps.</p><div id="dev2e5cbce6b" class="Task"><h2 role="button" aria-controls="aria-dev2e5cbce6b" aria-expanded="true" class="Name">Verify the development entitlements in Xcode</h2><div class="TaskBody" role="region" aria-hidden="false" id="aria-dev2e5cbce6b"><p>First ensure that the capabilities are enabled and entitlements are set for the <a href="deva2614151b.html#deva2614151b" class="xRef Aside">development provisioning profile</a>.</p><ol><li><p>In the <a href="devdab46c612.html#devdab46c612" class="xRef Aside">project editor</a>, choose the target from the Project/Targets pop-up menu, then click General.</p></li><li><p>If necessary, click the disclosure triangle next to the Signing section to reveal the settings.</p></li><li><p>Next to the provisioning profile name, click the information icon to see the details.</p><p>A popover appears containing the contents of the provisioning profile.</p></li><li><p>In the Capabilities and Entitlements section, verify that the capabilities you want to use are configured.</p></li></ol></div></div><div id="dev885f41c23" class="Task"><h2 role="button" aria-controls="aria-dev885f41c23" aria-expanded="true" class="Name">Verify the signature entitlements</h2><div class="TaskBody" role="region" aria-hidden="false" id="aria-dev885f41c23"><ol><li><p>In the <a href="dev7d7220fbb.html#dev7d7220fbb" class="xRef Aside">Project navigator</a> (<span class="NoBreak"><img src="Art/IDEStructureNavigatorTemplate.png" alt="" height="8" width="8">), </span>open the Products group under the project.</p></li><li><p>In the Products group, Control-click the build (a file with a <code>.app</code> extension), and choose “Show in Finder” from the shortcut menu.</p><p>Xcode opens the Finder to the location of the build location. </p></li><li><p>Launch Terminal (located in <code>/Applications/Utilities</code>), and enter this text followed by a space character (do not press Return):</p><div class="CodeLines"><code class="CodeLine">codesign -d --entitlements -</code></div></li><li><p>In the Finder, drag the <a href="dev7af8b1d18.html#dev7af8b1d18" class="xRef Aside">app binary</a> to Terminal.</p></li><li><p>Press Return.</p><p>For example, the output for an iOS app that is enabled for <a href="dev051fdb294.html#dev051fdb294" class="xRef Aside">iCloud Key-Value Storage</a> contains the <code>com.apple.developer.ubiquity-kvstore-identifier</code> entitlement key. The output for a macOS app that is enabled for App Sandbox contains the <code>com.apple.security.app-sandbox</code> entitlement key.</p><div class="CodeLines"><code class="CodeLine">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</code><code class="CodeLine">&lt;!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd"&gt;</code><code class="CodeLine">&lt;plist version="1.0"&gt;</code><code class="CodeLine">&lt;dict&gt;</code><code class="CodeLine">    &lt;key&gt;application-identifier&lt;/key&gt;</code><code class="CodeLine">    &lt;string&gt;G9B5P7QDV2.edu.self.HelloWorld&lt;/string&gt;</code><code class="CodeLine">    &lt;key&gt;com.apple.developer.pass-type-identifiers&lt;/key&gt;</code><code class="CodeLine">    &lt;array&gt;</code><code class="CodeLine">        &lt;string&gt;G9B5P7QDV2.*&lt;/string&gt;</code><code class="CodeLine">    &lt;/array&gt;</code><code class="CodeLine">    &lt;key&gt;com.apple.developer.ubiquity-container-identifiers&lt;/key&gt;</code><code class="CodeLine">    &lt;array&gt;</code><code class="CodeLine">        &lt;string&gt;G9B5P7QDV2.edu.self.HelloWorld&lt;/string&gt;</code><code class="CodeLine">    &lt;/array&gt;</code><code class="CodeLine">    &lt;key&gt;com.apple.developer.ubiquity-kvstore-identifier&lt;/key&gt;</code><code class="CodeLine">    &lt;string&gt;G9B5P7QDV2.edu.self.HelloWorld&lt;/string&gt;</code><code class="CodeLine">    &lt;key&gt;get-task-allow&lt;/key&gt;</code><code class="CodeLine">    &lt;true/&gt;</code><code class="CodeLine">&lt;/dict&gt;</code><code class="CodeLine">&lt;/plist&gt;</code></div></li></ol></div></div><div id="dev2228fb325" class="Task"><h2 role="button" aria-controls="aria-dev2228fb325" aria-expanded="true" class="Name">Locate the embedded provisioning profile in the build</h2><div class="TaskBody" role="region" aria-hidden="false" id="aria-dev2228fb325"><p>If the signature entitlements are different than what you have configured, verify that the embedded provisioning profile is correct. First, you need to locate the embedded provisioning profile.</p><ol><li><p>In the <a href="dev7d7220fbb.html#dev7d7220fbb" class="xRef Aside">Project navigator</a> (<span class="NoBreak"><img src="Art/IDEStructureNavigatorTemplate.png" alt="" height="8" width="8">), </span>Control-click the build under the Products group, and choose “Show in Finder” from the pop-up menu.</p><p>Xcode opens the Finder to the location of the build location. </p></li><li><p>In the Finder, Control-click the build (a file with a <code>.app</code> extension), and choose Show Package Contents from the pop-up menu.</p><p>For iOS apps, a provisioning profile called <code>embedded.mobileprovision</code> appears in the Finder window. For macOS apps, the embedded file is called <code>embedded.provisionprofile</code>.</p></li></ol><p>Alternatively, verify the entitlements in the distribution provisioning profile used when you <a href="dev23ea8b877.html#dev23ea8b877" class="xRef AppleTopic">export an iOS, tvOS, or watchOS app</a>, <a href="dev920940b13.html#dev920940b13" class="xRef AppleTopic">export a macOS app</a>, or <a href="dev442d7f2ca.html#dev442d7f2ca" class="xRef AppleTopic">upload an app to App Store Connect</a>. </p><p>In the Summary sheet, click the arrow next to the provisioning profile to show it in Finder.</p></div></div><div id="dev9d8b11e9d" class="Task"><h2 role="button" aria-controls="aria-dev9d8b11e9d" aria-expanded="true" class="Name">Verify the entitlements in the provisioning profile</h2><div class="TaskBody" role="region" aria-hidden="false" id="aria-dev9d8b11e9d"><ol><li><p>In Terminal, enter this text (do not press Return):</p><div class="CodeLines"><code class="CodeLine">security cms -D -i</code></div></li><li><p>In the Finder, drag the provisioning profile in the build to Terminal.</p></li><li><p>Press Return.</p><p>This command outputs a property list in XML format.</p></li><li><p>Locate the <code>Entitlements</code> key in the output and verify that the <code>application-identifier</code> key has the correct entitlements.</p><p>For example, the following listing shows an iOS app that is enabled for <a href="devc606b2721.html#devc606b2721" class="xRef Aside">data protection</a>, <a href="dev98a354360.html#dev98a354360" class="xRef Aside">Wallet</a>, and <a href="dev9cfa34dcf.html#dev9cfa34dcf" class="xRef Aside">iCloud</a>. iCloud entitlements begin with the text <code>com.apple.developer.ubiquity</code>.</p><div class="CodeLines"><code class="CodeLine">&lt;key&gt;Entitlements&lt;/key&gt;</code><code class="CodeLine">    &lt;dict&gt;</code><code class="CodeLine">        &lt;key&gt;application-identifier&lt;/key&gt;</code><code class="CodeLine">        &lt;string&gt;G9B5P7QDV2.*&lt;/string&gt;</code><code class="CodeLine">        &lt;key&gt;com.apple.developer.default-data-protection&lt;/key&gt;</code><code class="CodeLine">        &lt;string&gt;NSFileProtectionComplete&lt;/string&gt;</code><code class="CodeLine">        &lt;key&gt;com.apple.developer.pass-type-identifiers&lt;/key&gt;</code><code class="CodeLine">        &lt;array&gt;</code><code class="CodeLine">            &lt;string&gt;G9B5P7QDV2.*&lt;/string&gt;</code><code class="CodeLine">        &lt;/array&gt;</code><code class="CodeLine">        &lt;key&gt;com.apple.developer.ubiquity-container-identifiers&lt;/key&gt;</code><code class="CodeLine">        &lt;array&gt;</code><code class="CodeLine">            &lt;string&gt;G9B5P7QDV2.*&lt;/string&gt;</code><code class="CodeLine">        &lt;/array&gt;</code><code class="CodeLine">        &lt;key&gt;com.apple.developer.ubiquity-kvstore-identifier&lt;/key&gt;</code><code class="CodeLine">        &lt;string&gt;G9B5P7QDV2.*&lt;/string&gt;</code><code class="CodeLine">        &lt;key&gt;get-task-allow&lt;/key&gt;</code><code class="CodeLine">        &lt;true/&gt;</code><code class="CodeLine">        &lt;key&gt;inter-app-audio&lt;/key&gt;</code><code class="CodeLine">        &lt;true/&gt;</code><code class="CodeLine">        &lt;key&gt;keychain-access-groups&lt;/key&gt;</code><code class="CodeLine">        &lt;array&gt;</code><code class="CodeLine">            &lt;string&gt;G9B5P7QDV2.*&lt;/string&gt;</code><code class="CodeLine">        &lt;/array&gt;</code><code class="CodeLine">    &lt;/dict&gt;</code></div></li></ol></div></div><p>To learn more ways to use these commands, read the man pages (in Terminal, enter <code>man codesign</code> and <code>man security</code> respectively).</p><div class="LinkUniversal"><strong>See also</strong><a href="devd1432da9a.html#devd1432da9a" class="xRef AppleTopic">If a signing certificate or private key is missing</a><a href="devc4c7101d8.html#devc4c7101d8" class="xRef AppleTopic">If an intermediate certificate authority is missing</a><a href="dev01865b392.html#dev01865b392" class="xRef AppleTopic">If a code signing error occurs</a></div></body></html>