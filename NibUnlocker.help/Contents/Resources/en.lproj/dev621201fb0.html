<html lang="en"><head><meta charset="UTF-8"><title>If your project has a target dependency cycle</title><meta name="description" content="Your build will fail if you have a target dependency cycle."></head><body dir="ltr" id="dev621201fb0" class="AppleTopic apd-topic" data-isTaskOpen="false"><a name="dev621201fb0"></a><figure class="topicIcon"><img src="../GlobalArt/AppIconDefault.png" alt="" height="30" width="30"></figure><h1>If your project has a target dependency cycle</h1><p>The New Build System detects a cycle in dependencies between targets.</p><p>The steps of a build often involve high level targets, such as application targets, depending on lower-level targets, such as framework or library targets. The lower level targets are built first, so that the high level targets can link, embed, or otherwise use their products.</p><p>If targets have mutual dependencies on each other, a cycle is formed, and it is not correct to build either target first. These mutual dependencies may be direct, or they may be part of a chain that involves other intermediate targets. In either case a build may produce unreliable results.</p><p>The New Build System detects dependency cycles and produces a build error explaining the cycle that it detected. If you get this error, you should change the structure of the targets or source code to eliminate the cycle.</p><div class="Alert"><p class="Note"><em>Note: </em>To change the build system, go to <a href="dev396bc94c7.html#dev396bc94c7" class="xRef AppleTopic">Choose the build system</a>.</p></div><div id="deva4cec87cf" class="Task"><h2 role="button" aria-controls="aria-deva4cec87cf" aria-expanded="true" class="Name">If the cycle consists of target dependencies only</h2><div class="TaskBody" role="region" aria-hidden="false" id="aria-deva4cec87cf"><p>If your project contains a dependency cycle due to the dependencies between targets, the build fails with an error similar to:</p><div class="CodeLines"><code class="CodeLine">error: Cycle in dependencies between targets 'B' and 'A'; building could produce unreliable results.</code><code class="CodeLine">Cycle path: B → C → A → B</code><code class="CodeLine">Cycle details:</code><code class="CodeLine">→ Target 'B' has target dependency on Target 'C'</code><code class="CodeLine">→ Target 'C' has target dependency on Target 'A'</code><code class="CodeLine">→ Target 'A' has target dependency on Target 'B'</code></div><p>In this case, target A needs to be built in order to build target B, but target A also depends on target B.</p><p>In addition to dependencies explicitly declared in the "Target Dependencies" <a href="devffc690b03.html#devffc690b03" class="xRef Aside">build phase</a>, target dependencies are created implicitly when one target links against the framework or library product produced by another target. The target dependencies listed in this diagnostic may be explicit dependencies or implicit dependencies.</p><p>Follow these steps to fix this problem.</p><ol><li><p>First <a href="devcc9f6bfb2.html#dev637773cc9" class="xRef Task">delete unnecessary target dependencies</a>.</p></li><li><p>If the build still fails, restructure the project's source code or targets so the dependencies are no longer circular.</p></li></ol></div></div><div id="devbafb8a212" class="Task"><h2 role="button" aria-controls="aria-devbafb8a212" aria-expanded="true" class="Name">If the cycle contains the phrase "Target build order preserved because Parallelize Build is off"</h2><div class="TaskBody" role="region" aria-hidden="false" id="aria-devbafb8a212"><p>If you <a href="dev6a2c4394f.html#dev6a2c4394f" class="xRef AppleTopic">disable parallel builds</a>, the build system builds all the targets in a fixed order, based on how targets have been ordered in all “Target Dependencies” <a href="devffc690b03.html#devffc690b03" class="xRef Aside">build phases</a> and in the scheme's "Build" action. If this order produces a dependency cycle, the build fails with an error similar to:</p><div class="CodeLines"><code class="CodeLine">error: Cycle in dependencies between targets 'A' and 'B'; building could produce unreliable results.</code><code class="CodeLine">Cycle path: B → A → C → B</code><code class="CodeLine">Cycle details:</code><code class="CodeLine">Target build order preserved because “Parallelize Build” is off</code><code class="CodeLine">→ Target 'B' has link command with output '/Users/user/Library/Developer/Xcode/DerivedData/A-crxjtmxdssvpmxbeissnxefqwqtp/Build/Products/Debug/B.framework/Versions/A/B'</code><code class="CodeLine">○ Target 'B' has compile command with input '/Users/user/Library/Developer/Xcode/DerivedData/A-crxjtmxdssvpmxbeissnxefqwqtp/Build/Intermediates.noindex/A.build/Debug/A.build/DerivedSources/File.m'</code><code class="CodeLine">○ That command depends on command in Target 'A': script phase “Generate File.m”</code><code class="CodeLine">→ Target 'A' has target dependency on Target 'C' due to target order in a “Target Dependencies” build phase or the scheme</code><code class="CodeLine">→ Target 'C' has target dependency on Target 'B' due to target order in a “Target Dependencies” build phase or the scheme</code></div><p>In this case, target B depends on a file generated by target A, but the order configured in the project requires target B to be built before target A.</p><p>Follow these steps to fix this problem.</p><ol><li><p>First <a href="dev6a2c4394f.html#dev6a2c4394f" class="xRef AppleTopic">enable parallel builds</a> (enable the “Parallelize Build“ checkbox in the scheme).</p></li><li><p>If the build fails again, explicitly <a href="devcc9f6bfb2.html#devf6d47af57" class="xRef Task">add the required target dependencies</a>.</p></li><li><p>If the build still fails, reorder the targets in the scheme's Build action or <a href="devcc9f6bfb2.html#dev9c2a27a0e" class="xRef Task">reorder the dependent targets</a>.</p><p>Targets which are required early in the build should be listed before the targets which depend on them.</p></li></ol></div></div><div id="devd2ba2fa10" class="Task"><h2 role="button" aria-controls="aria-devd2ba2fa10" aria-expanded="true" class="Name">If the cycle contains script phases which are generating files</h2><div class="TaskBody" role="region" aria-hidden="false" id="aria-devd2ba2fa10"><p>Targets in your project may generate source files or resources which are needed to build other targets, but in an order that conflicts with the order determined by other dependencies. In that case, your build fails with an error similar to:</p><div class="CodeLines"><code class="CodeLine">error: Cycle in dependencies between targets 'A' and 'B'; building could produce unreliable results.</code><code class="CodeLine">Cycle path: A → B → A</code><code class="CodeLine">Cycle details:</code><code class="CodeLine">→ Target 'A' has target dependency on Target 'B'</code><code class="CodeLine">→ Target 'B' has compile command with input '/Users/user/Library/Developer/Xcode/DerivedData/A-fwfactyalkdlasagytkmozogzans/Build/Intermediates.noindex/A.build/Debug/A.build/DerivedSources/File.m'</code><code class="CodeLine">○ That command depends on command in Target 'A': script phase “Generate File.m”</code></div><p>In this case, target A depends on target B, but target B also needs a source file that is generated by target A. </p><p>Follow these steps to fix this problem.</p><ol><li><p>In the Target Dependencies build phase, verify whether the conflicting target dependencies are necessary.</p><p>If the given target doesn't need any of the products (for example, frameworks) of another target, <a href="devcc9f6bfb2.html#dev637773cc9" class="xRef Task">delete the target dependency</a>.</p></li><li><p>If all of the explicit target dependencies are necessary to build your project, restructure your project's source code or targets so your dependencies are no longer circular.</p></li></ol></div></div><div id="dev9749c269b" class="Task"><h2 role="button" aria-controls="aria-dev9749c269b" aria-expanded="true" class="Name">If the cycle is reported only during incremental builds</h2><div class="TaskBody" role="region" aria-hidden="false" id="aria-dev9749c269b"><p>To allow fast and correct incremental builds, every build after the initial build uses information discovered during the prior builds to learn about additional dependencies in your source code, such as included headers or imported modules. This may lead to dependency cycles which are only discovered after the first successful build and which make subsequent builds fail with an error similar to:</p><div class="CodeLines"><code class="CodeLine">error: Cycle in dependencies between targets 'A' and 'B'; building could produce unreliable results.</code><code class="CodeLine">Cycle path: A → B → A</code><code class="CodeLine">Cycle details:</code><code class="CodeLine">→ Target 'A' has link command with output '/Users/user/Library/Developer/Xcode/DerivedData/A-exhexvayjuazkmeqbiuraugfrmyy/Build/Products/Debug/A.framework/Versions/A/A'</code><code class="CodeLine">○ Target 'A' has compile command with input '/Users/user/Desktop/A/A/File.m'</code><code class="CodeLine">→ Target 'B' has write command with output /Users/user/Library/Developer/Xcode/DerivedData/A-exhexvayjuazkmeqbiuraugfrmyy/Build/Intermediates.noindex/A.build/Debug/B.build/module.modulemap</code><code class="CodeLine">○ Target 'B' has target dependency on Target 'A'</code></div><p>In this case, <code>File.m</code> is being compiled as part of target A and it includes the module B, but there is also an explicit target dependency from target B to target A.</p><div class="Alert"><p class="Note"><em>Note: </em>If the Enable Modules build setting is on, any import of headers from a module will import the whole module. This is why the cycle diagnostic lists the write command for the modulemap as a potential element in the cycle.</p><p>Follow these steps to fix this problem.</p></div><ol><li><p>Verify whether the conflicting target dependencies are necessary.</p><p>If the given target doesn't need any of the products (for example, frameworks) of another target, <a href="devcc9f6bfb2.html#dev637773cc9" class="xRef Task">delete the target dependency</a>.</p></li><li><p>Check the import statements of files being compiled by commands that are listed as part of the cycle.</p><p>It might be possible that some import statements are unnecessary and removing them will resolve the dependency cycle.</p></li><li><p>If the problem still persists, restructure your project's source code or targets so the dependencies are no longer circular.</p></li></ol></div></div></body></html>